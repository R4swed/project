<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞</title>
    <link href="/css/styles.css" rel="stylesheet">
    <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
</head>
<body>
    <div id="loginForm">
        <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
        <form>
            <div class="form-group">
                <label for="login-email">Email:</label>
                <input type="email" id="login-email" placeholder="–í–≤–µ–¥–∏—Ç–µ email">
            </div>
            <div class="form-group">
                <label for="login-password">–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="login-password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
            </div>
            <button type="submit">–í–æ–π—Ç–∏</button>
        </form>
        <p class="auth-link-text">
            –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" id="show-register">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
        </p>
    </div>

    <div id="registerForm" class="hidden">
        <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
        <form>
            <div class="form-group">
                <label for="register-email">Email:</label>
                <input type="email" id="register-email" placeholder="–í–≤–µ–¥–∏—Ç–µ email">
            </div>
            <div class="form-group">
                <label for="register-password">–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="register-password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
            </div>
            <button type="submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
        </form>
        <p class="auth-link-text">
            –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="#" id="show-login">–í–æ–π—Ç–∏</a>
        </p>
    </div>

    <div id="ticketForm" class="hidden">
        <div class="header">
            <span id="userEmail"></span>
            <button id="logoutBtn">–í—ã–π—Ç–∏</button>
        </div>
        <h2>–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏</h2>
        <form>
            <div class="form-group">
                <label for="company">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏:</label>
                <input type="text" id="company" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏">
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" placeholder="–í–≤–µ–¥–∏—Ç–µ email">
            </div>
            <div class="form-group">
                <label for="product">–ü—Ä–æ–¥—É–∫—Ç:</label>
                <select id="product">
                    <option value="" disabled selected>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–¥—É–∫—Ç</option>
                    <option value="product1">–ö—É—Ä—Å–æ—Ä</option>
                    <option value="product2">FaceGate</option>
                    <option value="product3">–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–∏—Å–ø–µ—Ç—á–µ—Ä—Å–∫–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è</option>
                    <option value="product4">–®–∫–∞—Ñ—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∏ –∏ —â–∏—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</option>
                    <option value="product5">–ü—Ä–æ—Ç–æ–∫–æ–ª</option>
                    <option value="product6">AutoGate</option>
                    <option value="product7">–°–∏—Å—Ç–µ–º–∞ –≤–∏–±—Ä–æ–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</option>
                    <option value="product8">–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤</option>
                    <option value="product9">–î—Ä—É–≥–æ–µ</option>
                </select>
            </div>
            <div class="form-group">
                <label for="subject">–¢–µ–º–∞:</label>
                <input type="text" id="subject" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–º—É">
            </div>
            <div class="form-group">
                <label for="description">–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:</label>
                <textarea id="description" placeholder="–û–ø–∏—à–∏—Ç–µ –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É –ø–æ–¥—Ä–æ–±–Ω–æ..."></textarea>
            </div>
            <div class="form-group">
                <label for="ticketFileInput">–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª:</label>
                <input type="file" id="ticketFileInput" accept="image/*,video/mp4" style="display: none">
                <button type="button" id="ticketAttachFileBtn" class="attach-file-btn">üìé –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª</button>
            </div>
            <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
        </form>
    </div>

    <div id="ticketList" class="hidden">
        <div class="header">
            <span id="ticketListUserEmail"></span>
            <button id="ticketListLogoutBtn">–í—ã–π—Ç–∏</button>
        </div>
        <h2>–í–∞—à–∏ –∑–∞—è–≤–∫–∏</h2>
        <div class="client-filters">
            <div class="search-filter">
                <input type="text" id="clientTicketSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Ç–µ–º–µ...">
            </div>
            <div class="status-filter">
                <select id="clientStatusFilter">
                    <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                    <option value="new">–ù–æ–≤—ã–µ</option>
                    <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                    <option value="completed">–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ</option>
                </select>
            </div>
            <div class="date-filter">
                <input type="date" id="clientDateFromFilter" placeholder="–û—Ç">
                <input type="date" id="clientDateToFilter" placeholder="–î–æ">
            </div>
        </div>
        <div id="ticketsContainer"></div>
        <button id="newTicketBtn">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞—è–≤–∫—É</button>
    </div>

    <div id="chatContainer" class="hidden">
        <div class="header">
            <span id="chatUserEmail"></span>
            <button id="backBtn">–ù–∞–∑–∞–¥</button>
        </div>
        <h2>–ß–∞—Ç –ø–æ –∑–∞—è–≤–∫–µ <span id="ticketId"></span></h2>
        <button id="takeTicketBtn" class="hidden">–í–∑—è—Ç—å –≤ —Ä–∞–±–æ—Ç—É</button>
        <button id="completeTicketBtn" class="hidden">–ó–∞–∫—Ä—ã—Ç—å –∑–∞—è–≤–∫—É</button>
        <div id="chatMessages" class="chat-messages"></div>
        <form id="messageForm">
            <div class="form-group">
                <textarea id="messageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."></textarea>
                <input type="file" id="fileInput" accept="image/*,video/mp4" style="display: none">
                <button type="button" id="attachFileBtn">üìé –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª</button>
            </div>
            <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </form>
    </div>

    <div id="supportDashboard" class="hidden">
        <div class="header">
            <span id="supportUserEmail"></span>
            <button id="supportLogoutBtn">–í—ã–π—Ç–∏</button>
        </div>
        <h2>–ü–∞–Ω–µ–ª—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏</h2>
        <div class="support-filters">
            <div class="search-filter">
                <input type="text" id="supportTicketSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Ç–µ–º–µ –∏–ª–∏ email...">
            </div>
            <div class="date-filter">
                <input type="date" id="supportDateFromFilter" placeholder="–û—Ç">
                <input type="date" id="supportDateToFilter" placeholder="–î–æ">
            </div>
        </div>
        <div class="filter-buttons">
            <button id="filterNewTickets">–ù–æ–≤—ã–µ</button>
            <button id="filterInProgressTickets">–í —Ä–∞–±–æ—Ç–µ</button>
            <button id="filterCompletedTickets">–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ</button>
        </div>
        <div id="supportTicketsContainer">
            <div id="newTicketsContainer" class="hidden">
                <h3>–ù–æ–≤—ã–µ –∑–∞—è–≤–∫–∏</h3>
                <div id="newTickets"></div>
            </div>
            <div id="in_progressTicketsContainer" class="hidden">
                <h3>–í —Ä–∞–±–æ—Ç–µ</h3>
                <div id="inProgressTickets"></div>
            </div>
            <div id="completedTicketsContainer" class="hidden">
                <h3>–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ</h3>
                <div id="completedTickets"></div>
            </div>
        </div>
    </div>

    <div id="adminDashboard" class="hidden">
        <div class="header">
            <span id="adminUserEmail"></span>
            <button id="adminLogoutBtn">–í—ã–π—Ç–∏</button>
        </div>

        <div class="admin-dashboard-header">
            <div class="analytics-section">
                <div class="date-filter">
                    <input type="date" id="adminDateFromFilter" placeholder="–û—Ç">
                    <input type="date" id="adminDateToFilter" placeholder="–î–æ">
                </div>
            </div>
            <div class="analytics-cards">
                <div class="analytics-card">
                    <h4>–ó–∞—è–≤–∫–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è</h4>
                    <p id="todayTickets">-</p>
                </div>
                <div class="analytics-card">
                    <h4>–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞</h4>
                    <p id="avgResponseTime">-</p>
                </div>
                <div class="analytics-card">
                    <h4>% –æ—Ç–≤–µ—Ç–æ–≤</h4>
                    <p id="responseRate">-</p>
                </div>
                <div class="analytics-card overdue-card">
                    <h4>–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ –æ—Ç–≤–µ—Ç–æ–≤</h4>
                    <p id="overdueResponseRate">-</p>
                </div>
            </div>
        </div>

        <div class="filter-buttons">
            <button id="showAllTickets">–í—Å–µ –∑–∞—è–≤–∫–∏</button>
            <button id="showAllStaff">–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</button>
            <button id="showStatistics">–ì—Ä–∞—Ñ–∏–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</button>
        </div>

        <div id="adminContent">
            <div id="allTicketsContainer">
                <h3>–í—Å–µ –∑–∞—è–≤–∫–∏</h3>
                <div class="admin-filters">
                    <div class="search-filter">
                        <input type="text" id="ticketSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º...">
                    </div>
                    <div class="status-filter">
                        <select id="statusFilter">
                            <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                            <option value="new">–ù–æ–≤—ã–µ</option>
                            <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                            <option value="completed">–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ</option>
                        </select>
                    </div>
                    <div class="product-filter">
                        <select id="productFilter">
                            <option value="all">–í—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã</option>
                            <option value="product1">–ö—É—Ä—Å–æ—Ä</option>
                            <option value="product2">FaceGate</option>
                            <option value="product3">–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–∏—Å–ø–µ—Ç—á–µ—Ä—Å–∫–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è</option>
                            <option value="product4">–®–∫–∞—Ñ—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∫–∏ –∏ —â–∏—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</option>
                            <option value="product5">–ü—Ä–æ—Ç–æ–∫–æ–ª</option>
                            <option value="product6">AutoGate</option>
                            <option value="product7">–°–∏—Å—Ç–µ–º–∞ –≤–∏–±—Ä–æ–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</option>
                            <option value="product8">–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤</option>
                            <option value="product9">–î—Ä—É–≥–æ–µ</option>
                        </select>
                    </div>
                </div>
                <div id="adminTicketsList"></div>
            </div>

            <div id="allStaffContainer" class="hidden">
                <h3>–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏</h3>
                <div class="staff-filters">
                    <div class="staff-sort-controls">
                        <label>–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ:</label>
                        <select id="staffSortSelect">
                            <option value="response_time">–°–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–∞</option>
                            <option value="completed">–ó–∞–∫—Ä—ã—Ç—ã–º –∑–∞—è–≤–∫–∞–º</option>
                        </select>
                    </div>
                    <input type="text" id="staffSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ –§–ò–û –∏–ª–∏ email...">
                    <button id="addStaffBtn" class="primary-button">+ –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</button>
                </div>
                <div id="staffList"></div>
            </div>

            <div id="statisticsContainer" class="hidden">
                <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—è–≤–æ–∫</h3>
                <div class="charts-grid">
                    <div class="chart-container">
                        <h4>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞—è–≤–æ–∫ –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º</h4>
                        <div id="productsChart"></div>
                    </div>
                    <div class="chart-container">
                        <h4>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏</h4>
                        <div id="responseTimeChart"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="addStaffModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h3>
                    <button class="close-modal">√ó</button>
                </div>
                <form id="addStaffForm">
                    <div class="form-group">
                        <label for="staffEmail">Email:</label>
                        <input type="email" id="staffEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="staffPassword">–ü–∞—Ä–æ–ª—å:</label>
                        <input type="password" id="staffPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="staffLastName">–§–∞–º–∏–ª–∏—è:</label>
                        <input type="text" id="staffLastName">
                    </div>
                    <div class="form-group">
                        <label for="staffFirstName">–ò–º—è:</label>
                        <input type="text" id="staffFirstName">
                    </div>
                    <div class="form-group">
                        <label for="staffMiddleName">–û—Ç—á–µ—Å—Ç–≤–æ(–ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏):</label>
                        <input type="text" id="staffMiddleName">
                    </div>
                    <button type="submit" class="primary-button">–î–æ–±–∞–≤–∏—Ç—å</button>
                </form>
            </div>
        </div>

        <div id="staffStatsModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ <span id="staffEmail"></span></h3>
                    <button class="close-modal">√ó</button>
                </div>
                <div class="staff-stats-filters">
                    <div class="date-filter">
                        <input type="date" id="staffStatsFromDate" placeholder="–û—Ç">
                        <input type="date" id="staffStatsToDate" placeholder="–î–æ">
                    </div>
                    <button id="applyStaffStatsFilter">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                </div>
                <div class="staff-analytics">
                    <div class="analytics-item">
                        <span class="analytics-label">–ó–∞—è–≤–∫–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è</span>
                        <span id="staffTodayTickets" class="analytics-value">-</span>
                    </div>
                    <div class="analytics-item">
                        <span class="analytics-label">–í—Å–µ–≥–æ –∑–∞—è–≤–æ–∫</span>
                        <span id="staffPeriodTickets" class="analytics-value">-</span>
                    </div>
                    <div class="analytics-item">
                        <span class="analytics-label">–í —Ä–∞–±–æ—Ç–µ</span>
                        <span id="staffInProgressTickets" class="analytics-value">-</span>
                    </div>
                    <div class="analytics-item">
                        <span class="analytics-label">–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ</span>
                        <span id="staffCompletedTickets" class="analytics-value">-</span>
                    </div>
                    <div class="analytics-item">
                        <span class="analytics-label">% –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫</span>
                        <span id="staffResponseRate" class="analytics-value">-</span>
                    </div>
                    <div class="analytics-item">
                        <span class="analytics-label">–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞</span>
                        <span id="staffAvgResponse" class="analytics-value">-</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="/js/utils.js"></script>
    <script type="module" src="/js/api.js"></script>
    <script type="module" src="/js/auth.js"></script>
    <script type="module" src="/js/chat.js"></script>
    <script type="module" src="/js/tickets.js"></script>
    <script type="module" src="/js/support.js"></script>
    <script type="module" src="/js/admin.js"></script>
    <script type="module" src="/js/main.js"></script>
</body>
</html>